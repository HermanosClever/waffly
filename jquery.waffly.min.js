(function(e){e.fn.waffly=function(t){var n,r,i,s,o,u,a,f=e.extend({class_name:"waffly",style_override:!1,default_color:"",graph_font:"arial, sans-serif",graph_title_color:"#05c",graph_value_color:"#05c",graph_color:"#05c",graph_value:"80%",graph_margin:"30px",graph_class:"sel",total_dots:100,graph_width:900,dot_row:10,dot_gap:2,dot_radius:"0%",dot_opacity:".5",graph_reverse:!1},t);this.each(function(){e(this).data("waffly-value")?f.graph_value=e(this).data("waffly-value").replace(",","."):f.graph_value=f.graph_value.replace(",",".");if(f.graph_value.indexOf(".")>-1){i=f.graph_value.split(".");i[1].length>3&&(f.graph_value=parseFloat(f.graph_value).toFixed(2)+"%")}n='<div class="'+f.class_name+'" style="-webkit-box-sizing: border-box;-moz-box-sizing: border-box;box-sizing: border-box;font-family:'+f.graph_font+";padding:"+f.graph_margin+";width:"+f.graph_width+'px;" title="'+e(this).text()+'">';n+='<div class="waffly_value" style="color:'+f.graph_value_color+';font-size:2.5em;font-weight:bold;margin:.5em 0 .25em;text-align:center">'+f.graph_value+"</div>";a=Math.floor((f.graph_width-parseInt(f.graph_margin)*2-(f.dot_row-1)*f.dot_gap)/f.dot_row);n+='<ul class="waffly_dots" style="font-size:0;list-style:none;margin:0;padding:0;">';u="";u+="border-radius:"+f.dot_radius+";";u+="display:inline-block;";u+="height:"+a+"px;";u+="margin:0 "+f.dot_gap+"px "+f.dot_gap+"px 0;";u+="width:"+a+"px;";opacity_styles="";if(f.default_color===""){s=f.graph_color;opacity_styles+="-ms-filter: 'progid:DXImageTransform.Microsoft.Alpha(Opacity="+f.dot_opacity*100+")';";opacity_styles+="filter: alpha(opacity="+f.dot_opacity*100+");";opacity_styles+="-moz-opacity: "+f.dot_opacity+";";opacity_styles+="-khtml-opacity: "+f.dot_opacity+";";opacity_styles+="opacity:"+f.dot_opacity+";"}else s=f.default_color;for(var t=0;t<f.total_dots;t++)t<parseInt(f.graph_value)?n+='<li class="waffly_dot d'+(t+1)+" "+f.graph_class+'" style="background:'+f.graph_color+";"+u+'"></li>':n+='<li class="waffly_dot d'+(t+1)+'" style="background:'+s+";"+u+opacity_styles+'"></li>';n+="</ul>";e(this).data("waffly-title")&&(n+='<div class="waffly_title" style="color:'+f.graph_title_color+';margin-top:.75em;text-align:center">'+e(this).data("waffly-title")+"</div>");n+="</div>";e(this).html(n)});return this}})(jQuery);